---
title: "TP-02 Javier Duque"
output: html_notebook
---

## Carga de los datos

Comenzamos leyendo el dataframe y se muestra la estructura de las variables, el tipo de datos

```{r echo=TRUE, message=FALSE, warning=FALSE}
#Se cargan las librerias a usar 
library(readr)
library(tidyverse)
library(tidymodels)
library(dplyr)
```

```{r echo=TRUE, warning=FALSE}
#Se lee el dataset y se procede a revisar la estructura de los datos
ar_properties <- read_rds("~/GitHub/EEA2019/TP-2/ar_properties.rds")
glimpse(ar_properties)
```

## 1. Regresión lineal múltiple

### a) Crear un modelo para predecir el precio con todas las covariables.
```{r echo=TRUE, warning=FALSE}
ar_propertieslm <- ar_properties %>%
  select(.,-c(id))

#Se realiza una regresion multiple de precio con respecto a todas las covariables
lmcompleto <- lm(price~., data = ar_propertieslm)
#ver el resultado del modelo
tidy(lmcompleto)
```

```{r echo=TRUE, warning=FALSE}
#Creamos las variables dummy para hacer la regresion multiple
ar_propdummy <- ar_properties %>% 
  mutate(l3 = paste("barrio", l3, sep = "_"),
         valor_barrio = 1,
         property_type = paste("tipo", property_type, sep = "_"),
         valor_tipo = 1
         ) 

ar_propdummy <- ar_propdummy %>%
  spread(key = property_type, value = valor_tipo, fill = 0) %>% 
  spread(key = l3, value = valor_barrio, fill = 0) %>%
  select(.,-c(id))

#Se realiza una regresion multiple de precio con respecto a todas las covariables
lmcompleto <- lm(price~., data = ar_propdummy)
#ver el resultado del modelo
tidy(lmcompleto)
```

### b) Analizar los resultados del modelo:

1. Interpretación de los coeficientes estimados
2. ¿Qué observan respecto de la significatividad de las variables dummy?
3. Medidas de evaluación del modelo
```{r echo=TRUE, warning=FALSE}
#Se realiza una regresion multiple de precio con respecto a todas las covariables
glance(lmcompleto)
```

### c) ¿Qué es preferible tener para vender?:
1. Un departamento de 120 mts cuadrados cubiertos en abasto, con 3 dormitorios y 2 baños
2. Un PH en balvanera, con 80 mts cuadrados cubiertos, 20 mts cuadrados no cubiertos, 2 dormitorios y 3 baños.


### d) Realizar un modelo sin la covariable l3 e interpretar sus resultados 
```{r echo=TRUE, warning=FALSE}
#Se realiza una regresion multiple de precio con respecto a todas las covariables excepto l3
ar_propertiesfilter <- ar_properties %>%
  select(.,-c(l3))


lmsinl3 <- lm(price~., data = ar_propertiesfilter)
#ver el resultado del modelo
tidy(lmsinl3)
```

### e) ¿Cuál es el modelo que mejor explica la variabilidad del precio?
